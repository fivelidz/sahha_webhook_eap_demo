"use strict";(()=>{var e={};e.id=335,e.ids=[335],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},52730:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>u,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>p});var o={};a.r(o),a.d(o,{GET:()=>c});var r=a(49303),i=a(88716),n=a(60670),s=a(87070);async function c(e){try{let{searchParams:t}=new URL(e.url),a=t.get("orgId")||"demo_techcorp_industries";if(console.log("\uD83D\uDD0D Device Information API: Fetching device data for org:",a),!process.env.SAHHA_CLIENT_ID||!process.env.SAHHA_CLIENT_SECRET)return console.error("❌ Missing Sahha credentials"),s.NextResponse.json({error:"Missing Sahha credentials"},{status:500});console.log("\uD83D\uDD10 Authenticating with Sahha...");let o=await fetch("https://sandbox-api.sahha.ai/oauth/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientId:process.env.SAHHA_CLIENT_ID,clientSecret:process.env.SAHHA_CLIENT_SECRET})});if(!o.ok)return console.error("❌ Sahha authentication failed:",o.status),s.NextResponse.json({error:"Authentication failed"},{status:401});let{accessToken:r}=await o.json();console.log("✅ Authentication successful"),console.log("\uD83D\uDCCA Fetching profiles for device information...");let i=await fetch(`https://sandbox-api.sahha.ai/api/v1/profile?organizationId=${a}`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!i.ok)return console.error("❌ Failed to fetch profiles:",i.status),s.NextResponse.json({error:"Failed to fetch profiles"},{status:500});let n=(await i.json()).profiles||[];console.log(`📊 Found ${n.length} profiles, generating device information...`);let c=n.map(e=>{let t;let a=e.profileId.split("").reduce((e,t)=>e+t.charCodeAt(0),0),o=(e,t=0)=>{let o=1e4*Math.sin(a+t);return Math.floor((o-Math.floor(o))*e)},r=o(3,1);switch(r){case 2:t={activity:7+o(4,2),sleep:9+o(5,3),vitals:8+o(7,4),body:4+o(5,5),characteristic:2+o(2,6)};break;case 1:t={activity:4+o(4,7),sleep:3+o(6,8),vitals:2+o(6,9),body:1+o(3,10),characteristic:o(2,11)};break;default:t={activity:2+o(3,12),sleep:o(3,13),vitals:o(2,14),body:o(1,15),characteristic:o(1,16)}}let i=Object.values(t).reduce((e,t)=>e+t,0);return{profileId:e.profileId,externalId:e.externalId,deviceType:"Mobile App",operatingSystem:0===o(2,17)?"iOS":"Android",deviceModel:"Mobile Device",appVersion:"1.0.0",dataCapabilities:t,hasWearableDevice:r>=1,dataSourceTypes:r>=1?["Mobile Sensors","Connected Devices"]:["Mobile Sensors"],completenessPercentage:Math.round(i/48*100)}}),l=c.length,d=c.filter(e=>e.hasWearableDevice).length,p=Math.round(c.reduce((e,t)=>e+t.dataCapabilities.activity,0)/l),h=Math.round(c.reduce((e,t)=>e+t.dataCapabilities.sleep,0)/l);return console.log(`✅ Generated device information for ${l} profiles (${d} with wearables)`),s.NextResponse.json({success:!0,data:c,summary:{totalProfiles:l,wearableProfiles:d,phoneOnlyProfiles:l-d,wearablePercentage:Math.round(d/l*100),averageBiomarkerAvailability:{activity:`${p}/10`,sleep:`${h}/13`}}})}catch(e){return console.error("❌ Device Information API error:",e),s.NextResponse.json({error:"Failed to fetch device information",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let l=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/sahha/device-information/route",pathname:"/api/sahha/device-information",filename:"route",bundlePath:"app/api/sahha/device-information/route"},resolvedPagePath:"/home/fivelidz/sahha_work/sahha-marketing-intelligence/projects/EAP/deployment-package/app/api/sahha/device-information/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:h}=l,u="/api/sahha/device-information/route";function f(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:p})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),o=t.X(0,[276,972],()=>a(52730));module.exports=o})();