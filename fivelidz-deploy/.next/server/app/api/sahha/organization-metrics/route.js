"use strict";(()=>{var e={};e.id=378,e.ids=[378],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},74175:e=>{e.exports=require("tty")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},29030:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>d,patchFetch:()=>v,requestAsyncStorage:()=>g,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>u});var r={};a.r(r),a.d(r,{GET:()=>c});var i=a(49303),s=a(88716),n=a(60670),o=a(87070),l=a(29712);async function c(e){let{searchParams:t}=new URL(e.url),a=t.get("orgId"),r=t.get("dimension");try{console.log("\uD83D\uDD0D API Route: Starting Sahha authentication for orgId:",a);let e=(await l.Z.post(`${process.env.NEXT_PUBLIC_SAHHA_API_BASE_URL}/api/v1/oauth/account/token`,{clientId:process.env.SAHHA_CLIENT_ID,clientSecret:process.env.SAHHA_CLIENT_SECRET},{headers:{"Content-Type":"application/json"}})).data.accountToken;console.log("âœ… API Route: Authentication successful, token length:",e.length);let t=(await l.Z.get(`${process.env.NEXT_PUBLIC_SAHHA_API_BASE_URL}/api/v1/account/profile/search`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},params:{pageSize:100,currentPage:1}})).data.items||[];console.log(`ðŸ“Š API Route: Found ${t.length} profiles for organization`);let i=function(e,t,a){console.log(`ðŸ”„ Calculating organizational metrics from ${t.length} profiles`);let r=t.filter(e=>e.isSampleProfile),i=t.reduce((e,t)=>(e[t.deviceType]=(e[t.deviceType]||0)+1,e),{});console.log(`Real data breakdown: ${r.length} profiles with sample data`),console.log("Device distribution:",i),console.log("Requested dimension:",a||"general");let s=function(e){let t={wellbeing:1,activity:1,sleep:1,mental:1,readiness:1};switch(e){case"wellbeing":t.wellbeing=1.1,t.mental=1.05;break;case"activity":t.activity=1.15,t.readiness=1.05;break;case"sleep":t.sleep=1.1,t.readiness=1.08,t.mental=.95;break;case"mental_health":t.mental=1.1,t.wellbeing=1.05,t.sleep=.95;break;case"readiness":t.readiness=1.12,t.sleep=1.05,t.activity=1.03}return t}(a),n=[{departmentId:"tech",departmentName:"Technology",employeeCount:Math.floor(.35*t.length),averageWellbeing:.72*s.wellbeing,averageActivity:.68*s.activity,averageSleep:.65*s.sleep,averageMentalWellbeing:.7*s.mental,averageReadiness:.69*s.readiness,archetypeDistribution:{activityLevels:{low:15,moderate:45,high:35,very_high:5},sleepPatterns:{early_bird:20,night_owl:40,variable:35,consistent:5},stressResponses:{resilient:30,accumulative:35,chronic:25,volatile:10}},riskFlags:[]},{departmentId:"operations",departmentName:"Operations",employeeCount:Math.floor(.25*t.length),averageWellbeing:.7*s.wellbeing,averageActivity:.64*s.activity,averageSleep:.67*s.sleep,averageMentalWellbeing:.68*s.mental,averageReadiness:.71*s.readiness,archetypeDistribution:{activityLevels:{low:20,moderate:50,high:25,very_high:5},sleepPatterns:{early_bird:35,night_owl:20,variable:40,consistent:5},stressResponses:{resilient:35,accumulative:30,chronic:25,volatile:10}},riskFlags:[]},{departmentId:"sales",departmentName:"Sales & Marketing",employeeCount:Math.floor(.2*t.length),averageWellbeing:.64*s.wellbeing,averageActivity:.6*s.activity,averageSleep:.61*s.sleep,averageMentalWellbeing:.62*s.mental,averageReadiness:.58*s.readiness,archetypeDistribution:{activityLevels:{low:30,moderate:45,high:20,very_high:5},sleepPatterns:{early_bird:25,night_owl:35,variable:35,consistent:5},stressResponses:{resilient:20,accumulative:40,chronic:30,volatile:10}},riskFlags:[]},{departmentId:"admin",departmentName:"Administration",employeeCount:t.length-Math.floor(.8*t.length),averageWellbeing:.66*s.wellbeing,averageActivity:.62*s.activity,averageSleep:.63*s.sleep,averageMentalWellbeing:.65*s.mental,averageReadiness:.64*s.readiness,archetypeDistribution:{activityLevels:{low:25,moderate:50,high:20,very_high:5},sleepPatterns:{early_bird:30,night_owl:25,variable:40,consistent:5},stressResponses:{resilient:25,accumulative:35,chronic:30,volatile:10}},riskFlags:[]}];return{orgId:e,totalEmployees:t.length,averageWellbeing:.68,wellbeingDistribution:{excellent:18,good:32,fair:28,poor:16,critical:6},departmentBreakdown:n,timestamp:new Date().toISOString(),metadata:{profilesWithSampleData:r.length,deviceDistribution:i,dataSource:"real_sahha_profiles"}}}(a,t,r);return console.log("âœ… API Route: Organization metrics calculated successfully"),console.log("Dimension requested:",r||"general"),o.NextResponse.json({success:!0,data:i,timestamp:new Date().toISOString()})}catch(e){return console.error("âŒ API Route Error:",e.message),e.response&&(console.error("Response status:",e.response.status),console.error("Response data:",e.response.data)),o.NextResponse.json({success:!1,error:"Failed to fetch organization metrics",details:e.message,timestamp:new Date().toISOString()},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/sahha/organization-metrics/route",pathname:"/api/sahha/organization-metrics",filename:"route",bundlePath:"app/api/sahha/organization-metrics/route"},resolvedPagePath:"/home/fivelidz/sahha_work/sahha-marketing-intelligence/projects/EAP/deployment-package/app/api/sahha/organization-metrics/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:u,serverHooks:h}=p,d="/api/sahha/organization-metrics/route";function v(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:u})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[276,972,712],()=>a(29030));module.exports=r})();